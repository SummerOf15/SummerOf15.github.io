---
layout: _hight
title: Hidden Markov Model(隐马尔可夫模型)(一)
date: 2018-10-16 16:04:26
tags: thesis_notes
mathjax: true
---
### 1. 基本概念
隐藏的马尔可夫链根据时间的变化生成的状态的序列称为`状态序列`（state sequence),根据这些状态实际观察到的序列为`观测序列`(observation sequence)
<!-- more -->
- 所有可能的状态集合 $Q=\{q_1,q_2,...,q_N\}$
- 所有可能的观测集合 $V=\{v_1,v_2,...,v_M\}$
- 长度为T的状态序列$I$及对应的观测序列$O$: $$I=\{i_1,i_2,...,i_T\}$$$$O=\{O_1,O_2,...,O_T\}$$
- 状态转移概率矩阵 $A=[a_{ij}]_{N \times N}$ 其中$a_{ij}=P(i_{t+1}=q_j \mid i_t=q_i)$表示在时刻$t$处于状态$q_i$的条件下在时刻$t+1$转移到$q_j$的概率。 
- 观测概率矩阵 $B=[b_j(k)]_{N\times M}$ 其中,$b_j(k)=P(o_t=v_k \mid i_t=q_j)$$ k=1,2,...,M;j=1,2,...,N$
表示在时刻$t$处于状态$q_j$的条件下生成观测$v_k$的概率。
- $\pi$是初始概率向量 $\pi = (\pi_i)$ 其中,$\pi_i=P(i_1=q_i)$是时刻$t=1$处于状态$q_i$的概率。

隐马尔可夫模型可以表示为：
$$ \lambda=(A,B,\pi)$$
$\pi$和$A$决定状态序列,$B$决定观测序列

隐马尔可夫模型基于两个假设：
1. 隐藏的马尔可夫链在任意时刻t的状态只与前一时刻的状态有关,与其它时刻的状态和观测无关。
2. 任意时刻的观测只和当前时刻的状态有关,与其它时刻的状态及观测无关。

### 2. 例子
下面通过一个例子来介绍一下隐马尔可夫模型的参数。
假设有三个盒子，分别编号box1,box2,box3，盒子里面分别有白球和红球。

- 则所有的状态集合$Q=\{box1,box2,box3\}$
- 所有的观测集合为$V=\{白球,红球\}$

现在从三个盒子中按照box1,box3,box2的次序依次拿一个球，拿出来的结果为：红，白，白。此时，

- 状态序列$I=\{box1,box3,box2\}$
- 观测序列$O=\{红，白，白\}$
- $T=3$

假设从box1取完球，再到box2取球的概率为$a_{12}$，并以此类推，则状态转移概率矩阵$A$为

$$
 \left[
 \begin{matrix}
   a_{11} & a_{12} & a_{13} \\
   a_{21} & a_{22} & a_{23} \\
   a_{31} & a_{32} & a_{33}
  \end{matrix}
  \right]
$$

假设在box1中摸到白球的概率为$P_{1白}$，摸到红球的概率为$P_{1红}$,以此类推。则观测概率矩阵$B$为

$$
 \left[
 \begin{matrix}
   P_{1白} & P_{1红}\\
   P_{2白} & P_{2红}\\
   P_{3白} & P_{3红}
  \end{matrix}
  \right]
$$

假如第一次去box1取球的概率为$\pi_1$，第一次去box2取球的概率为$\pi_2$，第一次去box3取球的概率为$\pi_3$，那么初始概率向量$\pi$可以表示为：

$$
 \left\{
 \begin{matrix}
   \pi_1 & \pi_2 & \pi_3
  \end{matrix}
  \right\}
$$


